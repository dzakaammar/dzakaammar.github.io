<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #F05454;
        }
    </style>

    
    
    
    
    
    

    
    <title>Singleton Pattern</title>
    <meta name="description" content="welcome to my zettelkasten">
    <meta name="keywords" content='dzaka, ammar, dzakaammar, dzakaammar blog, software_design, design_pattern, oop, golang'>

    <meta property="og:url" content="http://example.org/posts/202108151433_singleton_pattern/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Singleton Pattern">
    <meta property="og:description" content="welcome to my zettelkasten">
    <meta property="og:image" content="images/avatar.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Singleton Pattern">
    <meta name="twitter:description" content="welcome to my zettelkasten">
    <meta property="twitter:domain" content="http://example.org/posts/202108151433_singleton_pattern/">
    <meta property="twitter:url" content="http://example.org/posts/202108151433_singleton_pattern/">
    <meta name="twitter:image" content="images/avatar.png">

    
    <link rel="canonical" href="http://example.org/posts/202108151433_singleton_pattern/" />

    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="/css/dark.css">

    <script src="/js/feather-icons.min.js"></script>
    <script src="/js/main.js"></script>

    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QFVCGGK5X8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QFVCGGK5X8');
</script>
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="http://example.org/">
                <img src="images/avatar.png" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="http://example.org/">dzaka.ammar</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="/posts/"> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="/tags/"> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/dzakaammar"><span data-feather='github'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="/posts/"> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="/tags/"> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/dzakaammar"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">

    <div class="post-header-section">
        <h1>Singleton Pattern</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            August 16, 2021
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="/tags/software_design">software_design</a></li>
        
            <li class="post-tag"><a href="/tags/design_pattern">design_pattern</a></li>
        
            <li class="post-tag"><a href="/tags/oop">oop</a></li>
        
            <li class="post-tag"><a href="/tags/golang">golang</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>Singleton menyediakan cara untuk membuat <em>single instance</em> dan menyediakan cara untuk mengakses/menggunakan instance tersebut sebagai <em>global variable</em>. Memastikan hanya terdapat satu instance dari produk tertentu selama aplikasi berjalan.</p>
<h3 id="karakterstik">Karakterstik</h3>
<ul>
<li>Terdapat global variable untuk mendefine <em>single instance</em>. Dalam banyak implementasi, global variable tersebut memiliki default value dan tidak kosong, untuk selanjutnya bisa diganti melalui fungsi <em>setter</em></li>
<li>Adanya <em>setter function</em> untuk mengisi value dari instance tersebut</li>
<li>Adanya <em>getter function</em> untuk memberikan cara agar package lain atau client mengakses instance tersebut</li>
<li>Instance yang digukan untuk singleton harus bersifat private dan memastikan hanya dapat diubah/diisi sekali dalam compile time atau pun runtime</li>
<li>Harus <em>conccurent safe</em> dan <em>nil pointer safe</em> (jika default value adalah nil)</li>
</ul>
<blockquote>
<p>Untuk memastikan bahwa instance hanya dapat sekali diubah/diisi, implementasi di Go dapat menggunakan sync.Once.</p>
<p>Dan jika object yang dijadikan singleton ada structural type, maka bisa menggunakan abstraction atau interface agar object tersebut tidak dapat diubah dari sisi client. Hal ini terjadi karena object singleton acapkali berupa reference type (untuk menghindari passing by reference di <em>getter function</em>  dan membuat object bisa diubah dari sisi client), selain itu mencegah passing by value dimana akan selalu mengcopy instance tersebut di <em>getter function</em></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">logger</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Logger</span> <span style="color:#66d9ef">interface</span>{
	<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>)
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">loggerNoop</span> <span style="color:#66d9ef">struct</span>{}
<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">loggerImpl</span>) <span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) {}

<span style="color:#66d9ef">var</span> (
	<span style="color:#a6e22e">lgr</span> <span style="color:#a6e22e">Logger</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">loggerNoop</span>{} <span style="color:#75715e">// default logger noop
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">once</span> <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">Once</span>

)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Set</span>(<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">Logger</span>) {
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">l</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> { <span style="color:#66d9ef">return</span> }
	
	<span style="color:#75715e">// untuk memastikan bahwa hanya 1 kali call Set yang akan diproses
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// selama runtime
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">once</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#66d9ef">func</span>(){
		<span style="color:#a6e22e">lgr</span> = <span style="color:#a6e22e">l</span>
	})
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Get</span>() <span style="color:#a6e22e">Logger</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">lgr</span>
}

</code></pre></div><p>Dan implementasi disisi client</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;singleton/logger&#34;</span>

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">loggerWithFile</span> <span style="color:#66d9ef">struct</span>{
	<span style="color:#a6e22e">filename</span> <span style="color:#66d9ef">string</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">loggerWithFile</span>) <span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) {
	<span style="color:#75715e">// implementation
</span><span style="color:#75715e"></span>}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">loggerWithFile</span>{<span style="color:#a6e22e">filename</span>: <span style="color:#e6db74">&#34;test.txt&#34;</span>})
	
	<span style="color:#a6e22e">lgr</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Get</span>()
	<span style="color:#a6e22e">lgr</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;test&#34;</span>
}
</code></pre></div><p>Gunakan singleton pattern ketika dalam keseluruhan program mengharuskan adanya <em>single instance</em> yang dapat dishare. Namun, penggunakan singleton harus dibarengi dengan kontrol yang <em>strict</em> terhadap global variabel yang dibuat (<em>gurantees that just one instance of a class</em>)</p>
<h3 id="pros">Pros</h3>
<ul>
<li>Dengan cara ini dapat diyakini hanya akan terdapat <em>single instance</em> selama runtime</li>
<li>Instance tersebut dapat diakses secara global</li>
</ul>
<h3 id="cons">Cons</h3>
<ul>
<li>Single responsibility principle violation.</li>
<li>Perlu special treatment untuk menghandle <em>concurrent safe</em></li>
<li>Mungkin akan sulit untuk melakukan unit test, karena langsung terikat dengan global variable dan sulit untuk meng-override untuk keperluan mock</li>
</ul>

        </p>
    </div>
</div>



    

        </main><footer class="footer">
    <span>&copy; 2021 </span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
